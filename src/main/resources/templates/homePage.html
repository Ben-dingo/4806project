<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head th:fragment="header">
	<meta charset="UTF-8">
	<title>Course Viewer</title>
	<script src="https://code.jquery.com/jquery-1.12.4.js"></script>
	<script th:src="@{/js/address.js}"></script>
</head>
<body>
<div id="RadioForm">
	Select a search method.
	<form id="radioSet">
		<input type="radio" name="SearchType" value="prog" onClick="progSearch()">Search by Program<br>
		<input type="radio" name="SearchType" value="course" onClick="courseSearch()">Search by Course<br>
		<input type="radio" name="SearchType" value="cat" onClick="catSearch()">Search by Category<br>
	</form>
</div>

<div id="searchForm">
	<form id="varSearch">
		<label id="lab">Program name: </label>
		<input type="text" id="varia" name="progName" value="Sample text">
	</form>
</div>

<div id="YearForm" style="visibility:hidden">
	<form id="YearSearch">
		Year: <input type="text" name="yearVal" value="1"><br>
	</form>
</div>

<div id="SubForm">
	<form id="Submitting">
		<button type="button" onclick="searchFunc()">Search</button>
	</form>
</div>

<div>
    <p id="table"></p>
</div>

<div id="AdminForm">
	<form id="Adminlogon">
		<input type="text" id="password" value="password">
		<button type="button" onclick="logFunc()">Admin Login</button>
	</form>
</div>
</body>

<script language="Javascript">
    function progSearch() {
        document.getElementById('lab').innerHTML = 'Program Name: ';
        document.getElementById("YearForm").style.visibility="hidden";
    }
    function yearSearch() {
        document.getElementById('lab').innerHTML = 'Program Name: ';
        document.getElementById("YearForm").style.visibility="visible";
    }
    function courseSearch() {
        document.getElementById('lab').innerHTML = 'Course Name: ';
        document.getElementById("YearForm").style.visibility="hidden";
    }
    function catSearch() {
        document.getElementById('lab').innerHTML = 'Category Name: ';
        document.getElementById("YearForm").style.visibility="hidden";
    }

    function searchFunc() {
        let radios = document.getElementsByName("SearchType");
		if(radios[0].checked)
		{
			alert("Search by program not yet implimented");
		}
		else if(radios[1].checked)
		{
			$.ajax({
				url: window.location.protocol + "//" + window.location.hostname + "/viewCourse?id=" + document.getElementById("varia").value
			}).then(function(data){
				tableFunc(data, "Course");
			});
		}
		else if(radios[2].checked)
		{
			$.ajax({
				url: window.location.protocol + "//" + window.location.hostname + "/viewCat?id=" + document.getElementById("varia").value
			}).then(function(data){
				tableFunc(data,"Category");
			});
		}
		else{alert("Please select a search type.");}
    }

    function tableFunc(data, searchType){
		let results = data.toString().slice(0, -1).split("(");

		let objectives = results[1].split(",");
		var output = "<header>Search by " + searchType + ": " + document.getElementById("varia").value + "</header>";
		output += "<table border='5'>\n" +
				"<tr>" +
				"<th>Outcome Name</th>" +
				"<th>Outcome description</th>" +
				"</tr>";
		for (var i = 0; i < objectives.length; i++) {
			let objective = objectives[i].split(":");
			output += "<tr>" +
					"<th>" + objective[0] + "</th>" +
					"<th>" + objective[1] + "</th>" +
					"</tr>";
		}
		output += "</table>";
		document.getElementById("table").innerHTML = output;
	}

    function logFunc() {
        var password = document.getElementById("password").value;
        if(password == "IAmAdmin"){location.href= "admin"}
        else{alert("THERE WILL BE CONSEQUENCES!");}
    }
</script>

<!--<input type="radio" name="SearchType" value="year" onClick="yearSearch()">Search Program by Year-->

</html>